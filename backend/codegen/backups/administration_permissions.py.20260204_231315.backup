"""
Permissions pour l'application administration.
"""
from rest_framework import permissions


class CanViewAdministration(permissions.BasePermission):
    def has_permission(self, request, view):
        return request.user.is_authenticated and (
            request.user.is_staff or request.user.has_perm("administration.view_administration")
        )


class CanCreateAdministration(permissions.BasePermission):
    def has_permission(self, request, view):
        return request.user.is_authenticated and (
            request.user.is_staff or request.user.has_perm("administration.add_administration")
        )


class CanUpdateAdministration(permissions.BasePermission):
    def has_permission(self, request, view):
        return request.user.is_authenticated and (
            request.user.is_staff or request.user.has_perm("administration.change_administration")
        )


class CanDeleteAdministration(permissions.BasePermission):
    def has_permission(self, request, view):
        return request.user.is_authenticated and (
            request.user.is_staff or request.user.has_perm("administration.delete_administration")
        )


# --- AnneeAcademique ---
class CanViewAnneeAcademique(permissions.BasePermission):
    """Lecture (GET) : is_staff ou permission view_anneeacademique."""
    def has_permission(self, request, view):
        if request.method in ("GET", "HEAD", "OPTIONS"):
            return request.user.is_authenticated and (
                request.user.is_staff or request.user.has_perm("administration.view_anneeacademique")
            )
        return True


class CanCreateAnneeAcademique(permissions.BasePermission):
    """Création (POST) : is_staff ou permission add_anneeacademique."""
    def has_permission(self, request, view):
        if request.method == "POST":
            return request.user.is_authenticated and (
                request.user.is_staff or request.user.has_perm("administration.add_anneeacademique")
            )
        return True


class CanUpdateAnneeAcademique(permissions.BasePermission):
    """Modification (PUT, PATCH) : is_staff ou permission change_anneeacademique."""
    def has_permission(self, request, view):
        if request.method in ("PUT", "PATCH"):
            return request.user.is_authenticated and (
                request.user.is_staff or request.user.has_perm("administration.change_anneeacademique")
            )
        return True


class CanDeleteAnneeAcademique(permissions.BasePermission):
    """Suppression (DELETE) : is_staff ou permission delete_anneeacademique."""
    def has_permission(self, request, view):
        if request.method == "DELETE":
            return request.user.is_authenticated and (
                request.user.is_staff or request.user.has_perm("administration.delete_anneeacademique")
            )
        return True


# --- Niveau ---
class CanViewNiveau(permissions.BasePermission):
    """Lecture (GET) : is_staff ou permission view_niveau."""
    def has_permission(self, request, view):
        if request.method in ("GET", "HEAD", "OPTIONS"):
            return request.user.is_authenticated and (
                request.user.is_staff or request.user.has_perm("administration.view_niveau")
            )
        return True


class CanCreateNiveau(permissions.BasePermission):
    """Création (POST) : is_staff ou permission add_niveau."""
    def has_permission(self, request, view):
        if request.method == "POST":
            return request.user.is_authenticated and (
                request.user.is_staff or request.user.has_perm("administration.add_niveau")
            )
        return True


class CanUpdateNiveau(permissions.BasePermission):
    """Modification (PUT, PATCH) : is_staff ou permission change_niveau."""
    def has_permission(self, request, view):
        if request.method in ("PUT", "PATCH"):
            return request.user.is_authenticated and (
                request.user.is_staff or request.user.has_perm("administration.change_niveau")
            )
        return True


class CanDeleteNiveau(permissions.BasePermission):
    """Suppression (DELETE) : is_staff ou permission delete_niveau."""
    def has_permission(self, request, view):
        if request.method == "DELETE":
            return request.user.is_authenticated and (
                request.user.is_staff or request.user.has_perm("administration.delete_niveau")
            )
        return True


# --- Filiere ---
class CanViewFiliere(permissions.BasePermission):
    """Lecture (GET) : is_staff ou permission view_filiere."""
    def has_permission(self, request, view):
        if request.method in ("GET", "HEAD", "OPTIONS"):
            return request.user.is_authenticated and (
                request.user.is_staff or request.user.has_perm("administration.view_filiere")
            )
        return True


class CanCreateFiliere(permissions.BasePermission):
    """Création (POST) : is_staff ou permission add_filiere."""
    def has_permission(self, request, view):
        if request.method == "POST":
            return request.user.is_authenticated and (
                request.user.is_staff or request.user.has_perm("administration.add_filiere")
            )
        return True


class CanUpdateFiliere(permissions.BasePermission):
    """Modification (PUT, PATCH) : is_staff ou permission change_filiere."""
    def has_permission(self, request, view):
        if request.method in ("PUT", "PATCH"):
            return request.user.is_authenticated and (
                request.user.is_staff or request.user.has_perm("administration.change_filiere")
            )
        return True


class CanDeleteFiliere(permissions.BasePermission):
    """Suppression (DELETE) : is_staff ou permission delete_filiere."""
    def has_permission(self, request, view):
        if request.method == "DELETE":
            return request.user.is_authenticated and (
                request.user.is_staff or request.user.has_perm("administration.delete_filiere")
            )
        return True


# --- Classe ---
class CanViewClasse(permissions.BasePermission):
    """Lecture (GET) : is_staff ou permission view_classe."""
    def has_permission(self, request, view):
        if request.method in ("GET", "HEAD", "OPTIONS"):
            return request.user.is_authenticated and (
                request.user.is_staff or request.user.has_perm("administration.view_classe")
            )
        return True


class CanCreateClasse(permissions.BasePermission):
    """Création (POST) : is_staff ou permission add_classe."""
    def has_permission(self, request, view):
        if request.method == "POST":
            return request.user.is_authenticated and (
                request.user.is_staff or request.user.has_perm("administration.add_classe")
            )
        return True


class CanUpdateClasse(permissions.BasePermission):
    """Modification (PUT, PATCH) : is_staff ou permission change_classe."""
    def has_permission(self, request, view):
        if request.method in ("PUT", "PATCH"):
            return request.user.is_authenticated and (
                request.user.is_staff or request.user.has_perm("administration.change_classe")
            )
        return True


class CanDeleteClasse(permissions.BasePermission):
    """Suppression (DELETE) : is_staff ou permission delete_classe."""
    def has_permission(self, request, view):
        if request.method == "DELETE":
            return request.user.is_authenticated and (
                request.user.is_staff or request.user.has_perm("administration.delete_classe")
            )
        return True


# --- Matiere ---
class CanViewMatiere(permissions.BasePermission):
    """Lecture (GET) : is_staff ou permission view_matiere."""
    def has_permission(self, request, view):
        if request.method in ("GET", "HEAD", "OPTIONS"):
            return request.user.is_authenticated and (
                request.user.is_staff or request.user.has_perm("administration.view_matiere")
            )
        return True


class CanCreateMatiere(permissions.BasePermission):
    """Création (POST) : is_staff ou permission add_matiere."""
    def has_permission(self, request, view):
        if request.method == "POST":
            return request.user.is_authenticated and (
                request.user.is_staff or request.user.has_perm("administration.add_matiere")
            )
        return True


class CanUpdateMatiere(permissions.BasePermission):
    """Modification (PUT, PATCH) : is_staff ou permission change_matiere."""
    def has_permission(self, request, view):
        if request.method in ("PUT", "PATCH"):
            return request.user.is_authenticated and (
                request.user.is_staff or request.user.has_perm("administration.change_matiere")
            )
        return True


class CanDeleteMatiere(permissions.BasePermission):
    """Suppression (DELETE) : is_staff ou permission delete_matiere."""
    def has_permission(self, request, view):
        if request.method == "DELETE":
            return request.user.is_authenticated and (
                request.user.is_staff or request.user.has_perm("administration.delete_matiere")
            )
        return True


# --- AdministrationEcole ---
class CanViewAdministrationEcole(permissions.BasePermission):
    """Lecture (GET) : is_staff ou permission view_administrationecole."""
    def has_permission(self, request, view):
        if request.method in ("GET", "HEAD", "OPTIONS"):
            return request.user.is_authenticated and (
                request.user.is_staff or request.user.has_perm("administration.view_administrationecole")
            )
        return True


class CanCreateAdministrationEcole(permissions.BasePermission):
    """Création (POST) : is_staff ou permission add_administrationecole."""
    def has_permission(self, request, view):
        if request.method == "POST":
            return request.user.is_authenticated and (
                request.user.is_staff or request.user.has_perm("administration.add_administrationecole")
            )
        return True


class CanUpdateAdministrationEcole(permissions.BasePermission):
    """Modification (PUT, PATCH) : is_staff ou permission change_administrationecole."""
    def has_permission(self, request, view):
        if request.method in ("PUT", "PATCH"):
            return request.user.is_authenticated and (
                request.user.is_staff or request.user.has_perm("administration.change_administrationecole")
            )
        return True


class CanDeleteAdministrationEcole(permissions.BasePermission):
    """Suppression (DELETE) : is_staff ou permission delete_administrationecole."""
    def has_permission(self, request, view):
        if request.method == "DELETE":
            return request.user.is_authenticated and (
                request.user.is_staff or request.user.has_perm("administration.delete_administrationecole")
            )
        return True
